{% from "govuk/components/back-link/macro.njk" import govukBackLink %}
{% from "govuk/components/fieldset/macro.njk" import govukFieldset %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% extends '_layout.njk' %}

{% block pageTitle %}Manage attachments - Admin - {{ serviceName }}{% endblock %}

{% block beforeContent %}
  <div class="govuk-breadcrumbs">
    <ol class="govuk-breadcrumbs__list">
      <li class="govuk-breadcrumbs__list-item">
        <a class="govuk-breadcrumbs__link" href="/">Home</a>
      </li>
      <li class="govuk-breadcrumbs__list-item">
        <a class="govuk-breadcrumbs__link" href="/admin/index">Admin</a>
      </li>
    </ol>
  </div>
{% endblock %}

<div class="govuk-width-container">

    {% block content %}
    <div class="govuk-grid-row">
        <div id="file-list-body" class="govuk-grid-column-full">
            {% if model.errors | length > 0 %}
                {{ govukErrorSummary({
                    titleText: "There is a problem",
                    errorList: model.errors
                }) }}
            {% endif %}
            <h1 class="govuk-heading-l">Manage attachments</h1>
            <form class="form" method="post" id="file-attachments" action="">
                <p>Files showing <strong class="govuk-tag defra-tag-nowrap govuk-tag--green">LIVE</strong> will be added to emails as attachments. Additional files may be uploaded, tested, and made live. Press 'Revoke' to relegate a file from <strong class="govuk-tag defra-tag-nowrap govuk-tag--green">LIVE</strong>. Each <strong class="govuk-tag defra-tag-nowrap govuk-tag--green">LIVE</strong> file must have a unique filename.</p>
                <h2 class="govuk-heading-m">Attachments for Application Pack email/letter</h2>
                <table class="govuk-table govuk-!-margin-bottom-7" id="attachment-table">
                    <caption class="govuk-visually-hidden">Attachment templates</caption>
                    <thead class="govuk-table__head">
                    <tr class="govuk-table__row">
                        <th scope="col" class="govuk-table__header">Filename</th>
                        <th scope="col" class="govuk-table__header">Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% if model.attachments | length > 0 %}
                        {% for attachment in model.attachments %}
                        <tr class="govuk-table__row">
                            <td class="govuk-table__cell defra-align-table">{{ attachment.filename }}</td>
                            <td class="govuk-table__cell defra-align-table">
                                <button type="submit" class="govuk-button govuk-button--secondary govuk-!-margin-bottom-0" data-module="govuk-button" name="test" value="{{ attachment.filename }}">
                                    Test
                                </button>
                                {% if attachment.isLive === false %}
                                &nbsp;&nbsp;
                                <button type="submit" class="govuk-button govuk-button--secondary govuk-!-margin-bottom-0" data-module="govuk-button" name="remove" value="{{ attachment.filename }}">
                                    Remove
                                </button>
                                &nbsp;&nbsp;
                                <button type="submit" class="govuk-button govuk-button--secondary govuk-!-margin-bottom-0" data-module="govuk-button" name="golive" value="{{ attachment.filename }}">
                                    Go live
                                </button>
                                {% else %}
                                &nbsp;&nbsp;
                                <button type="submit" class="govuk-button govuk-button--secondary govuk-!-margin-bottom-0" data-module="govuk-button" name="revoke" value="{{ attachment.filename }}">
                                    Revoke
                                </button>
                                &nbsp;&nbsp;&nbsp;
                                <strong class="govuk-tag defra-tag-nowrap govuk-tag--green govuk-!-margin-top-1">LIVE</strong>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr class="govuk-table__row">
                            <td class="govuk-table__cell defra-align-table">No attachments</td>
                            <td class="govuk-table__cell defra-align-table govuk-table__cell--numeric"></td>
                        </tr>
                    {% endif %}
                    </tbody>
                </table>
            </form>
            <div class="govuk-button-group">
              <a class="govuk-link govuk-link--no-visited-state" href="/admin/attachments/upload">Upload a file</a>
            </div>
        </div>
    </div>

    {% endblock %}
</div>
